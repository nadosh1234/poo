def analyze_custom_data(text):
    reference_ranges = {
        "WBCs": (4.0, 10.0),
        "RBCs": (3.8, 4.8),
        "HGB'": (12.0, 15.0),
        "HOT": (36.0, 46.0),
        "MGV": (83.0, 101.0),
        "MCH": (27.0, 32.0),
        "MCHC": (31.5, 34.5),
        "PLT": (150, 410),
        "RDW": (11.5, 14.5)
    }

    advice_dict = {
        "WBCs": {
            "high": "قد يدل على وجود عدوى أو التهاب. يُنصح بمراجعة الطبيب.",
            "low": "قد يشير إلى ضعف المناعة أو مشاكل في نخاع العظم. يُفضل مراجعة الطبيب."
        },
        "RBCs": {
            "high": "قد يكون بسبب نقص الأكسجين المزمن أو مشاكل في القلب أو الرئة.",
            "low": "يشير غالبًا إلى فقر دم. يُنصح بإجراء فحوصات إضافية للحديد أو فيتامين B12."
        },
        "HGB": {
            "high": "قد يدل على جفاف أو أمراض في الدم. راجع طبيب مختص.",
            "low": "قد يشير إلى أنيميا أو نقص حديد. يُفضل إجراء فحص إضافي."
        },
        "HOT": {
            "high": "قد يدل على جفاف أو مشاكل في الرئة. يُنصح بشرب سوائل واستشارة طبيب.",
            "low": "قد يشير إلى أنيميا أو فقدان دم. يُفضل التحقق من نسبة الحديد."
        },
        "MGV": {
            "high": "قد يدل على نقص فيتامين B12 أو حمض الفوليك. يُنصح بإجراء تحليل فيتامينات.",
            "low": "قد يشير إلى نقص الحديد أو الثلاسيميا. راجع طبيب مختص."
        },
        "MCH": {
            "high": "مرتبط بـ MCV، وقد يشير إلى أنيميا كبيرة الحجم.",
            "low": "قد يدل على أنيميا صغيرة الحجم بسبب نقص الحديد."
        },
        "MCHC": {
            "high": "قد يدل على كريات دم مشبعة بالهيموغلوبين بشكل زائد.",
            "low": "يرتبط غالبًا بالأنيميا. يُنصح بتحليل مكمل."
        },
        "PLT": {
            "high": "قد يدل على التهابات أو مشاكل في الدم. راجع الطبيب.",
            "low": "قد يشير إلى اضطراب في نخاع العظم أو نقص في بعض الفيتامينات."
        },
        "RDW": {
            "high": "تفاوت في حجم كريات الدم الحمراء، قد يشير إلى أنواع من الأنيميا.",
            "low": "نادراً ما يكون منخفض، لكن يشير إلى انتظام في حجم الخلايا."
        }
    }

    results = []
    for line in text.split('\n'):
        for key in reference_ranges:
            if key in line:
                try:
                    value = float(line.split()[-1])
                    low, high = reference_ranges[key]
                    if value < low:
                        status = "منخفض عن الطبيعي"
                        advice = advice_dict.get(key, {}).get("low", "")
                    elif value > high:
                        status = "مرتفع عن الطبيعي"
                        advice = advice_dict.get(key, {}).get("high", "")
                    else:
                        status = "ضمن المعدل الطبيعي"
                        advice = ""
                    results.append({
                        "item": key,
                        "value": value,
                        "status": status,
                        "range": f"{low} - {high}",
                        "advice": advice
                    })
                except:
                    continue
    return results
